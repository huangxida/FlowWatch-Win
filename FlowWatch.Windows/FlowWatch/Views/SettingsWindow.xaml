<Window x:Class="FlowWatch.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="clr-namespace:FlowWatch.ViewModels"
        Title="{DynamicResource Settings.WindowTitle}"
        Width="480" Height="620"
        ResizeMode="NoResize"
        WindowStartupLocation="CenterScreen"
        Style="{StaticResource SettingsWindowStyle}"
        ShowInTaskbar="True">
    <Window.DataContext>
        <vm:SettingsViewModel/>
    </Window.DataContext>

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="32,28,32,28">

            <!-- Header -->
            <TextBlock Text="{DynamicResource Settings.Header}" FontSize="20" FontWeight="SemiBold"
                       Foreground="{StaticResource TextBrush}" Margin="0,0,0,24"/>

            <!-- Section: General -->
            <TextBlock Text="{DynamicResource Settings.General}" FontSize="11.5" FontWeight="Medium"
                       Foreground="{StaticResource HintBrush}" Margin="0,0,0,10"
                       />

            <Border Background="{StaticResource CardBackgroundBrush}"
                    BorderBrush="{StaticResource CardBorderBrush}" BorderThickness="1"
                    CornerRadius="8" Padding="16,4">
                <StackPanel>
                    <!-- Language -->
                    <DockPanel Margin="0,10,0,10">
                        <TextBlock Text="{DynamicResource Settings.Language}" Style="{StaticResource FieldLabelStyle}"
                                   DockPanel.Dock="Left" VerticalAlignment="Center"/>
                        <ComboBox SelectedValue="{Binding Language}" SelectedValuePath="Tag"
                                  Style="{StaticResource SettingsComboBoxStyle}"
                                  DockPanel.Dock="Right" HorizontalAlignment="Right"
                                  Width="140" VerticalAlignment="Center">
                            <ComboBoxItem Content="{DynamicResource Settings.LanguageAuto}" Tag="auto"/>
                            <ComboBoxItem Content="English" Tag="en"/>
                            <ComboBoxItem Tag="zh">中文</ComboBoxItem>
                        </ComboBox>
                    </DockPanel>

                    <Border Style="{StaticResource DividerStyle}"/>

                    <!-- Refresh interval -->
                    <DockPanel Margin="0,10,0,10">
                        <StackPanel DockPanel.Dock="Left" VerticalAlignment="Center">
                            <TextBlock Text="{DynamicResource Settings.RefreshRate}" Style="{StaticResource FieldLabelStyle}"/>
                            <TextBlock Style="{StaticResource HintStyle}" Text="{DynamicResource Settings.RefreshRateHint}"/>
                        </StackPanel>
                        <StackPanel DockPanel.Dock="Right" HorizontalAlignment="Right"
                                    VerticalAlignment="Center" Orientation="Horizontal">
                            <Slider Value="{Binding RefreshIntervalSeconds}" Width="120"
                                    Minimum="1" Maximum="10" IsSnapToTickEnabled="True"
                                    TickFrequency="1" Style="{StaticResource SettingsSliderStyle}"
                                    VerticalAlignment="Center"/>
                            <TextBlock Style="{StaticResource ValueStyle}" Width="32"
                                       TextAlignment="Right" VerticalAlignment="Center" Margin="8,0,0,0">
                                <TextBlock.Text>
                                    <Binding Path="RefreshIntervalSeconds" StringFormat="{}{0}s"/>
                                </TextBlock.Text>
                            </TextBlock>
                        </StackPanel>
                    </DockPanel>

                    <Border Style="{StaticResource DividerStyle}"/>

                    <!-- Auto launch -->
                    <DockPanel Margin="0,10,0,10">
                        <StackPanel DockPanel.Dock="Left" VerticalAlignment="Center">
                            <TextBlock Text="{DynamicResource Settings.AutoLaunch}" Style="{StaticResource FieldLabelStyle}"/>
                            <TextBlock Style="{StaticResource HintStyle}" Text="{DynamicResource Settings.AutoLaunchHint}"/>
                        </StackPanel>
                        <CheckBox IsChecked="{Binding AutoLaunch}"
                                  Style="{StaticResource ToggleSwitchStyle}"
                                  DockPanel.Dock="Right" HorizontalAlignment="Right"
                                  VerticalAlignment="Center"/>
                    </DockPanel>
                </StackPanel>
            </Border>

            <!-- Section: Window -->
            <TextBlock Text="{DynamicResource Settings.Window}" FontSize="11.5" FontWeight="Medium"
                       Foreground="{StaticResource HintBrush}" Margin="0,20,0,10"
                       />

            <Border Background="{StaticResource CardBackgroundBrush}"
                    BorderBrush="{StaticResource CardBorderBrush}" BorderThickness="1"
                    CornerRadius="8" Padding="16,4">
                <StackPanel>
                    <!-- Lock on top -->
                    <DockPanel Margin="0,10,0,10">
                        <StackPanel DockPanel.Dock="Left" VerticalAlignment="Center">
                            <TextBlock Text="{DynamicResource Settings.LockOnTop}" Style="{StaticResource FieldLabelStyle}"/>
                            <TextBlock Style="{StaticResource HintStyle}" Text="{DynamicResource Settings.LockOnTopHint}"/>
                        </StackPanel>
                        <CheckBox IsChecked="{Binding LockOnTop}"
                                  Style="{StaticResource ToggleSwitchStyle}"
                                  DockPanel.Dock="Right" HorizontalAlignment="Right"
                                  VerticalAlignment="Center"/>
                    </DockPanel>

                    <Border Style="{StaticResource DividerStyle}"/>

                    <!-- Pin to desktop -->
                    <DockPanel Margin="0,10,0,10">
                        <StackPanel DockPanel.Dock="Left" VerticalAlignment="Center">
                            <TextBlock Text="{DynamicResource Settings.PinToDesktop}" Style="{StaticResource FieldLabelStyle}"/>
                            <TextBlock Style="{StaticResource HintStyle}" Text="{DynamicResource Settings.PinToDesktopHint}"/>
                        </StackPanel>
                        <CheckBox IsChecked="{Binding PinToDesktop}"
                                  Style="{StaticResource ToggleSwitchStyle}"
                                  DockPanel.Dock="Right" HorizontalAlignment="Right"
                                  VerticalAlignment="Center"/>
                    </DockPanel>

                    <Border Style="{StaticResource DividerStyle}"/>

                    <!-- Layout -->
                    <DockPanel Margin="0,10,0,10">
                        <TextBlock Text="{DynamicResource Settings.Layout}" Style="{StaticResource FieldLabelStyle}"
                                   DockPanel.Dock="Left" VerticalAlignment="Center"/>
                        <ComboBox SelectedValue="{Binding Layout}" SelectedValuePath="Tag"
                                  Style="{StaticResource SettingsComboBoxStyle}"
                                  DockPanel.Dock="Right" HorizontalAlignment="Right"
                                  Width="120" VerticalAlignment="Center">
                            <ComboBoxItem Content="{DynamicResource Settings.LayoutHorizontal}" Tag="horizontal"/>
                            <ComboBoxItem Content="{DynamicResource Settings.LayoutVertical}" Tag="vertical"/>
                        </ComboBox>
                    </DockPanel>

                    <Border Style="{StaticResource DividerStyle}"/>

                    <!-- Display mode -->
                    <DockPanel Margin="0,10,0,10">
                        <TextBlock Text="{DynamicResource Settings.DisplayMode}" Style="{StaticResource FieldLabelStyle}"
                                   DockPanel.Dock="Left" VerticalAlignment="Center"/>
                        <ComboBox SelectedValue="{Binding DisplayMode}" SelectedValuePath="Tag"
                                  Style="{StaticResource SettingsComboBoxStyle}"
                                  DockPanel.Dock="Right" HorizontalAlignment="Right"
                                  Width="120" VerticalAlignment="Center">
                            <ComboBoxItem Content="{DynamicResource Settings.DisplaySpeed}" Tag="speed"/>
                            <ComboBoxItem Content="{DynamicResource Settings.DisplayUsage}" Tag="usage"/>
                            <ComboBoxItem Content="{DynamicResource Settings.DisplayBoth}" Tag="both"/>
                        </ComboBox>
                    </DockPanel>
                </StackPanel>
            </Border>

            <!-- Section: Appearance -->
            <TextBlock Text="{DynamicResource Settings.Appearance}" FontSize="11.5" FontWeight="Medium"
                       Foreground="{StaticResource HintBrush}" Margin="0,20,0,10"
                       />

            <Border Background="{StaticResource CardBackgroundBrush}"
                    BorderBrush="{StaticResource CardBorderBrush}" BorderThickness="1"
                    CornerRadius="8" Padding="16,4">
                <StackPanel>
                    <!-- Font family -->
                    <StackPanel Margin="0,10,0,10">
                        <TextBlock Text="{DynamicResource Settings.Font}" Style="{StaticResource FieldLabelStyle}" Margin="0,0,0,8"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            <ComboBox x:Name="FontPresetCombo" Grid.Column="0"
                                      Style="{StaticResource SettingsComboBoxStyle}"
                                      SelectionChanged="OnFontPresetChanged" Margin="0,0,8,0"
                                      Width="160">
                                <ComboBoxItem Content="{DynamicResource Settings.FontPreset}" Tag=""/>
                                <ComboBoxItem Content="Segoe UI" Tag="Segoe UI, Microsoft YaHei, sans-serif"/>
                                <ComboBoxItem Content="Microsoft YaHei" Tag="Microsoft YaHei, Segoe UI, sans-serif"/>
                                <ComboBoxItem Content="Arial" Tag="Arial, Helvetica, sans-serif"/>
                                <ComboBoxItem Content="Consolas" Tag="Consolas, Courier New, monospace"/>
                            </ComboBox>
                            <TextBox Grid.Column="1"
                                     Text="{Binding FontFamily, UpdateSourceTrigger=PropertyChanged}"
                                     Style="{StaticResource SettingsTextBoxStyle}"/>
                        </Grid>
                    </StackPanel>

                    <Border Style="{StaticResource DividerStyle}"/>

                    <!-- Font size -->
                    <DockPanel Margin="0,10,0,10">
                        <TextBlock Text="{DynamicResource Settings.FontSize}" Style="{StaticResource FieldLabelStyle}"
                                   DockPanel.Dock="Left" VerticalAlignment="Center"/>
                        <StackPanel DockPanel.Dock="Right" HorizontalAlignment="Right"
                                    Orientation="Horizontal" VerticalAlignment="Center">
                            <Slider Value="{Binding FontSize}" Width="120"
                                    Minimum="11" Maximum="19" IsSnapToTickEnabled="True"
                                    TickFrequency="1" Style="{StaticResource SettingsSliderStyle}"
                                    VerticalAlignment="Center"/>
                            <TextBlock Style="{StaticResource ValueStyle}" Width="36"
                                       TextAlignment="Right" VerticalAlignment="Center" Margin="8,0,0,0">
                                <TextBlock.Text>
                                    <Binding Path="FontSize" StringFormat="{}{0}px"/>
                                </TextBlock.Text>
                            </TextBlock>
                        </StackPanel>
                    </DockPanel>

                    <Border Style="{StaticResource DividerStyle}"/>

                    <!-- Color max -->
                    <StackPanel Margin="0,10,0,10">
                        <DockPanel>
                            <TextBlock Text="{DynamicResource Settings.ColorMax}" Style="{StaticResource FieldLabelStyle}"
                                       DockPanel.Dock="Left" VerticalAlignment="Center"/>
                            <TextBlock Style="{StaticResource ValueStyle}"
                                       DockPanel.Dock="Right" HorizontalAlignment="Right"
                                       VerticalAlignment="Center">
                                <TextBlock.Text>
                                    <Binding Path="SpeedColorMaxMbps" StringFormat="{}{0} Mbps"/>
                                </TextBlock.Text>
                            </TextBlock>
                        </DockPanel>
                        <TextBlock Style="{StaticResource HintStyle}"
                                   Text="{DynamicResource Settings.ColorMaxHint}" Margin="0,2,0,6"/>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="80"/>
                            </Grid.ColumnDefinitions>
                            <Slider Grid.Column="0" Value="{Binding SpeedColorMaxMbps}"
                                    Minimum="1" Maximum="1000" IsSnapToTickEnabled="True"
                                    TickFrequency="1" Style="{StaticResource SettingsSliderStyle}"
                                    VerticalAlignment="Center"/>
                            <TextBox Grid.Column="1"
                                     Text="{Binding SpeedColorMaxMbps, UpdateSourceTrigger=PropertyChanged}"
                                     Style="{StaticResource SettingsTextBoxStyle}" Margin="8,0,0,0"/>
                        </Grid>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Section: Traffic Statistics -->
            <TextBlock Text="{DynamicResource Settings.TrafficStats}" FontSize="11.5" FontWeight="Medium"
                       Foreground="{StaticResource HintBrush}" Margin="0,20,0,10"
                       />

            <Border Background="{StaticResource CardBackgroundBrush}"
                    BorderBrush="{StaticResource CardBorderBrush}" BorderThickness="1"
                    CornerRadius="8" Padding="16,12">
                <StackPanel>
                    <DockPanel>
                        <TextBlock Text="{DynamicResource Settings.StartTime}" Style="{StaticResource FieldLabelStyle}"
                                   DockPanel.Dock="Left" VerticalAlignment="Center"/>
                        <TextBlock Text="{Binding TrafficStartTimeText}"
                                   Style="{StaticResource ValueStyle}"
                                   DockPanel.Dock="Right" HorizontalAlignment="Right"
                                   VerticalAlignment="Center"/>
                    </DockPanel>
                    <TextBlock Style="{StaticResource HintStyle}"
                               Text="{DynamicResource Settings.StartTimeHint}" Margin="0,2,0,12"/>
                    <Button Content="{DynamicResource Settings.ResetStats}" Command="{Binding ResetTrafficCommand}"
                            Style="{StaticResource SecondaryButtonStyle}"
                            HorizontalAlignment="Stretch"/>
                </StackPanel>
            </Border>

        </StackPanel>
    </ScrollViewer>
</Window>
